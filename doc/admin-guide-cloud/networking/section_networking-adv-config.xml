<?xml version="1.0" encoding="UTF-8"?>
<section xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
    xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0"
    xml:id="section_networking-advanced-config">
    <title>Advanced configuration options</title>
    <para>This section describes advanced configuration options for various system components. For
        example, configuration options where the default works but that the user wants to customize
        options. After installing from packages, <literal>$NEUTRON_CONF_DIR</literal> is
            <filename>/etc/neutron</filename>.</para>
    <section xml:id="section_adv_cfg_l3_metering_agent">
        <title>L3 metering agent</title>
        <para>You can run an L3 metering agent that enables layer-3 traffic metering. In general,
            you should launch the metering agent on all nodes that run the L3 agent:</para>
        <screen><userinput>neutron-metering-agent --config-file <replaceable>NEUTRON_CONFIG_FILE</replaceable> --config-file <replaceable>L3_METERING_CONFIG_FILE</replaceable></userinput></screen>
        <para>You must configure a driver that matches the plug-in that runs on the service. The
            driver adds metering to the routing interface.</para>
        <table rules="all">
            <caption>Settings</caption>
            <thead>
                <tr>
                    <th>Option</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><emphasis role="bold">Open vSwitch</emphasis></td>
                    <td/>
                </tr>
                <tr>
                    <td>interface_driver ($NEUTRON_CONF_DIR/metering_agent.ini)</td>
                    <td>neutron.agent.linux.interface.OVSInterfaceDriver</td>
                </tr>
                <tr>
                    <td><emphasis role="bold">Linux Bridge</emphasis></td>
                    <td/>
                </tr>
                <tr>
                    <td>interface_driver ($NEUTRON_CONF_DIR/metering_agent.ini)</td>
                    <td>neutron.agent.linux.interface.BridgeInterfaceDriver</td>
                </tr>
            </tbody>
        </table>
        <section xml:id="adv_cfg_l3_metering_agent_namespace">
            <title>Namespace</title>
            <para>The metering agent and the L3 agent must have the same network namespaces
                configuration.</para>
            <note>
                <para>If the Linux installation does not support network namespaces, you must
                    disable network namespaces in the L3 metering configuration file. The default
                    value of the <option>use_namespaces</option> option is <code>True</code>.</para>
            </note>
            <para><programlisting language="ini">use_namespaces = False</programlisting></para>
        </section>
        <section xml:id="adv_cfg_l3_metering_agent_driver">
            <title>L3 metering driver</title>
            <para>You must configure any driver that implements the metering abstraction. Currently
                the only available implementation uses iptables for metering.</para>
            <para><programlisting language="ini">driver = neutron.services.metering.drivers.iptables.iptables_driver.IptablesMeteringDriver</programlisting></para>
        </section>
        <section xml:id="adv_cfg_l3_metering_service_driver">
            <title>L3 metering service driver</title>
            <para>To enable L3 metering, you must set the following option in the
                    <filename>neutron.conf</filename> file on the host that runs <systemitem
                    class="service">neutron-server</systemitem>:</para>
            <programlisting language="ini">service_plugins = metering</programlisting>
        </section>
    </section>
</section>
