<?xml version="1.0" encoding="UTF-8"?>
<section xmlns="http://docbook.org/ns/docbook"
    xmlns:xi="http://www.w3.org/2001/XInclude"
    xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0"
    xml:id="basic-install_controller-cinder">
    <title>Cinder</title>
	<para>
                <orderedlist>
                    <listitem>
                        <para>Install the packages
                    :<screen os="ubuntu"><userinput>apt-get install -y cinder-api cinder-scheduler cinder-volume iscsitarget \
    open-iscsi iscsitarget-dkms python-cinderclient linux-headers-`uname -r`</userinput></screen><screen os="centos;rhel;fedora"><userinput>yum install -y openstack-cinder openstack-cinder-doc \
        iscsi-initiator-utils scsi-target-utils</userinput></screen></para>
                    </listitem>
                    <listitem>
                        <para>Configure &amp; start the iSCSI services
                    :<screen os="ubuntu"><userinput>sed -i 's/false/true/g' /etc/default/iscsitarget
service iscsitarget start
service open-iscsi start</userinput></screen><screen os="centos;rhel;fedora"><userinput>service tgtd start
service iscsi start
chkconfig tgtd on
chkconfig iscsi on</userinput></screen></para>
                    </listitem>
                    <listitem>
                        <para>Configure Cinder :</para>
                        <itemizedlist>
                            <listitem>
                                <para>Edit <emphasis role="bold">/etc/cinder/cinder.conf</emphasis>
                            file and modify:
                                    <screen>
                                        <userinput>[DEFAULT]
sql_connection = mysql://cinder:password@localhost:3306/cinder</userinput></screen>
<screen><userinput os='ubuntu'>rabbit_password = password</userinput>
                                    </screen>
                                    <screen><userinput os='centos;rhel;fedora'>rpc_backend = cinder.openstack.common.rpc.impl_qpid
qpid_user = guest
qpid_password = quest
                                    </userinput>
                                    </screen>
                                    <screen><userinput>
[keystone_authtoken]
admin_tenant_name = service
admin_user = cinder
admin_password = password
</userinput></screen></para>
                            </listitem>
                            <listitem>
                                <para>Edit <emphasis role="bold">/etc/cinder/api-paste.ini</emphasis> file and modify:
                                    <screen><userinput>admin_tenant_name = service
admin_user = cinder 
admin_password = password</userinput></screen></para>
                            </listitem>
                            <listitem>
                                <para>Create the volume (on the second disk):<screen><userinput>fdisk /dev/sdb

[Create a Linux partition]

pvcreate /dev/sdb1
vgcreate cinder-volumes /dev/sdb1</userinput></screen></para>
                            </listitem>
                            <listitem>
                                <para>Create Cinder tables into the database :<screen><userinput>cinder-manage db sync</userinput></screen></para>
                            </listitem>
                            <listitem>
                                <para>Restart the services :<screen os='ubuntu'><userinput>service cinder-api restart
service cinder-scheduler restart
service cinder-volume restart</userinput></screen>
                                    <screen os='centos;rhel;fedora'><userinput>service openstack-cinder-api restart
service openstack-cinder-scheduler restart
service openstack-cinder-volume restart
chkconfig openstack-cinder-api on
chkconfig openstack-cinder-scheduler on
chkconfig openstack-cinder-volume on</userinput></screen></para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                </orderedlist>
            </para>
</section>
