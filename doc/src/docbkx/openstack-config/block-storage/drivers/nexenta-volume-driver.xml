<section xml:id="nexenta-driver"
    xmlns="http://docbook.org/ns/docbook"
    xmlns:xi="http://www.w3.org/2001/XInclude"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    version="5.0">
    <title>Nexenta Drivers</title>
    <para>
        NexentaStor Appliance is NAS/SAN software platform designed for
        building reliable and fast network storage arrays. The Nexenta Storage
        Appliance uses ZFS as a disk management system. NexentaStor can serve
        as a storage node for the OpenStack and for the virtual servers through
        iSCSI and NFS protocols.
    </para>
    <!-- iSCSI driver section -->
    <section xml:id="nexenta-iscsi-driver">
        <title>Nexenta iSCSI driver</title>
        <para>
            The Nexenta iSCSI driver allows you to use Nexenta SA to store
            Compute volumes. Every Compute volume is represented by a single
            zvol in a predefined Nexenta volume. For every new volume the
            driver creates a iSCSI target and iSCSI target group that are used
            to access it from compute hosts.
        </para>
        <para>
            To use Compute with Nexenta Storage Appliance iSCSI driver, you
            should set this options in <filename>cinder.conf</filename>:
        </para>
        <itemizedlist>
            <listitem>
                <para>set
                    <code>
                        volume_driver =
                        cinder.volume.drivers.nexenta.volume.NexentaDriver
                    </code>;
                </para>
            </listitem>
            <listitem>
                <para>
                    set <code>nexenta_host</code> flag to the hostname or IP of
                    your NexentaStor;
                </para>
            </listitem>
            <listitem>
                <para>
                    set <code>nexenta_user</code> and
                    <code>nexenta_password</code> to the username and password
                    of the user with all necessary privileges on the appliance,
                    including the access to REST API;
                </para>
            </listitem>
            <listitem>
                <para>
                    set <code>nexenta_volume</code> to the name of the volume
                    on the appliance that you would like to use in Compute, or
                    create a volume named <code>cinder</code> (it will be used
                    by default).
                </para>
            </listitem>
        </itemizedlist>
        <para>
            Nexenta driver has a lot of tunable flags. Some of them you might
            want to change the following values:
        </para>
        <itemizedlist>
            <listitem>
                <para>
                    <code>nexenta_target_prefix</code> defines the prefix that
                    is prepended to volume id to form target name on Nexenta;
                </para>
            </listitem>
            <listitem>
                <para>
                    <code>nexenta_target_group_prefix</code> defines the prefix
                    for target groups;
                </para>
            </listitem>
            <listitem>
                <para>
                    <code>nexenta_blocksize</code> can be set to the size of
                    the blocks in newly created zvols on appliance, with the
                    suffix; for example, the default 8K means 8 kilobytes;
                </para>
            </listitem>
            <listitem>
                <para>
                    <code>nexenta_sparse</code> is boolean and can be set to
                    use sparse zvols to save space on appliance.
                </para>
            </listitem>
        </itemizedlist>
        <para>
            Some flags that you might want to keep with the default values:
        </para>
        <itemizedlist>
            <listitem>
                <para>
                    <code>nexenta_rest_port</code> is the port where Nexenta
                    listens for REST requests (the same port where the NMV
                    works);
                </para>
            </listitem>
            <listitem>
                <para>
                    <code>nexenta_rest_protocol</code> can be set to
                    <code>http</code> or <code>https</code>, but the default is
                    <code>auto</code> which makes the driver try to use HTTP
                    and switch to HTTPS in case of failure;
                </para>
            </listitem>
            <listitem>
                <para>
                    <code>nexenta_iscsi_target_portal_port</code> is the port
                    to connect to Nexenta over iSCSI.
                </para>
            </listitem>
        </itemizedlist>
    </section>
    <!-- / iSCSI driver section -->
</section>
