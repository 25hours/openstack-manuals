[tox]
minversion = 1.6
envlist = checkniceness,checksyntax,checkdeletions,checkbuild
skipsdist = True

[testenv]
setenv =
   VIRTUAL_ENV={envdir}
deps = -r{toxinidir}/test-requirements.txt
whitelist_externals =
   echo
   rm

[testenv:venv]
commands = {posargs}

[testenv:checkniceness]
commands = openstack-doc-test --check-niceness {posargs}

[testenv:checksyntax]
commands = openstack-doc-test --check-syntax {posargs}

[testenv:checkdeletions]
commands = openstack-doc-test --check-deletions {posargs}

[testenv:checkbuild]
commands = openstack-doc-test --check-build {posargs}

[testenv:publishdocs]
# Prepare all documents that are published for stable/havana so that
# they can get published on docs.openstack.org with just copying
# publish-docs/* over.
commands =
  openstack-doc-test --check-build --only-book install-guide --only-book config-reference --nocreate-index
  # Remove www directory, it's in the wrong location and should not be
  # published here
  rm -rf publish-docs/www

[testenv:buildlang-install]
# Run as "tox -e buildlang-install -- $LANG"
commands = echo "Not supported on stable/havana"

[testenv:buildlang-misc]
# Run as "tox -e buildlang-misc -- $LANG"
commands = echo "Not supported on stable/havana"
